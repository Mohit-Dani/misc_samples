/* Menu Bar Script - Warning: Still being tested. - Do not remove this notice. - Copyright 2000-2005 by Mike Hall. - See http://www.brainjar.com for terms of use. */
var z=(document.all!=null&&window.opera==null);var y=(window.opera!=null);var x=(window.scrollX!=null);var w=false&&!y;var v=3;var u=2;var t=null;var s;if(z){document.documentElement.attachEvent("onfocusin",A);document.documentElement.attachEvent("onkeydown",B);document.documentElement.attachEvent("onmousedown",C);}else{document.documentElement.addEventListener("focus",A,true);document.documentElement.addEventListener("keydown",B,true);document.documentElement.addEventListener("mousedown",C,true);}function A(a){var b=(z?window.event.srcElement:(a.target.tagName?a.target:a.target.parentNode));if(t==null)return;if(b==t)return;if(U(b,"A","menuButton")==null&&U(b,"DIV","menu")==null)E();}function B(a){s=(z?window.event.type:a.type);}function C(a){s=(z?window.event.type:a.type);A(a);}function D(a){if(a==t)return;E();if(a.c==null)return;X(a,"menuButtonActive");var b=Z(a);b.s+=a.offsetHeight;K(a.c,b);t=a;}function E(){if(t==null)return;Y(t,"menuButtonActive");if(t.c!=null)L(t.c);t=null;}function F(a,b){var c=I(a,b);if(s=="mousedown"){if(z)document.documentElement.detachEvent("onfocusin",A);c.blur();if(z)document.documentElement.attachEvent("onfocusin",A);}if(c==t)E();else D(c);return false;}function G(a,b){var c=I(a,b);if(t!=null&&c!=t)D(c);}function H(a){var b=(z?window.event.keyCode:a.keyCode);if(b<37||b>40)return;var c=I(a,null);if(b==37)c.l.focus();if(b==39)c.m.focus();if(c.c!=null&&(b==38||b==40)){D(c);if(b==38)c.n.focus();if(b==40)c.o.focus();}return false;}function I(a,b){var c=(z?U(window.event.srcElement,"A","menuButton"):a.currentTarget);if(c.b==null){c.b=U(c,"DIV","menuBar");if(c.b.a==null)c.b.a=V(c.b,"A","menuButton");var i=0;while(c.b.a[i]!=c)i++;var n=c.b.a.length;c.l=(i==0?c.b.a[n-1]:c.b.a[i-1]);c.m=(i==n-1?c.b.a[0]:c.b.a[i+1]);if(b!=null){c.c=document.getElementById(b);c.c.d=c;J(c.c);c.n=c.c.g[c.c.g.length-1];c.o=c.c.g[0];}if(!y)c.onkeydown=H;if(x)c.onkeypress=T;}return c;}function J(a){a.g=V(a,"A","menuItem");var b=a.g.length,c,d,e,f,g,h;if(b>0)c=a.g[0].offsetWidth;else return;if(z){d=document.createElement("IFRAME");d.frameBorder=0;d.src="javascript:;";d.style.display="none";d.style.position="absolute";d.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";a.p=a.parentNode.insertBefore(d,a);}for(var d=0;d<b;d++){a.g[d].n=(d==0?a.g[b-1]:a.g[d-1]);a.g[d].o=(d==b-1?a.g[0]:a.g[d+1]);a.g[d].l=(a.e!=null?a.e:a.d.l);a.g[d].m=a.d.m;var f=a.g[d].getElementsByTagName("SPAN");var g=null;var h=null;for(var i=0;i<f.length;i++){if(W(f[i],"menuItemText"))g=f[i];if(W(f[i],"menuItemArrow")){h=f[i];}}if(g!=null&&h!=null){g.style.paddingRight=(c-(g.offsetWidth+h.offsetWidth))+"px";if(z){h.style.fontFamily="Webdings";h.style.fontSize="100%";h.firstChild.nodeValue="4";}if(y){h.firstChild.nodeValue="\u25B6";h.style.marginRight="0em";}}else{a.g[d].onfocus=Q;a.g[d].onmouseover=Q;}if(!y)a.g[d].onkeydown=R;if(x)a.g[d].onkeypress=T;}if(z){d=a.g[0].offsetWidth;a.g[0].style.width=d+"px";e=a.g[0].offsetWidth-d;d-=e;a.g[0].style.width=d+"px";}if(w){a.q=new Array();for(d=0;d<v;d++){var e=document.createElement("DIV");e.className="menuShadow";a.q[d]=a.parentNode.insertBefore(e,a);}}a.onmouseover=O;a.k=false;}function K(a,b){a.style.left=b.r+"px";a.style.top=b.s+"px";a.style.visibility="visible";if(a.p!=null){a.p.style.left=a.style.left;a.p.style.top=a.style.top;a.p.style.width=a.offsetWidth+(w?u+v-1:0)+"px";a.p.style.height=a.offsetHeight+(w?u+v-1:0)+"px";a.p.style.display="";}if(w){for(var i=0;i<v;i++){a.q[i].style.left=(b.r+u+i)+"px";a.q[i].style.top=(b.s+u+i)+"px";a.q[i].style.width=a.offsetWidth+"px";a.q[i].style.height=a.offsetHeight+"px";a.q[i].style.visibility="visible";}}a.k=true;}function L(a){N(a);if(w)for(var i=0;i<v;i++)a.q[i].style.visibility="";a.style.visibility="";if(a.p!=null)a.p.style.display="none";a.k=false;}function M(a){if(a.f.style.visibility=="")return;N(a.f);X(a,"menuItemActive");a.f.h=a;if(a.i==null||a.j!=null){a.j=null;return;}var b=Z(a),c,d;b.r+=a.offsetWidth;if(z)b.s-=a.i.clientTop;if(z){c=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)+(document.documentElement.clientWidth!=0?document.documentElement.clientWidth:document.body.clientWidth);d=Math.max(document.documentElement.scrollTop,document.body.scrollTop)+(document.documentElement.clientHeight!=0?document.documentElement.clientHeight:document.body.clientHeight);}if(y){c=document.documentElement.scrollLeft+window.innerWidth;d=document.documentElement.scrollTop+window.innerHeight;}if(x){c=window.scrollX+window.innerWidth;d=window.scrollY+window.innerHeight;}c-=a.i.offsetWidth;d-=a.i.offsetHeight;if(b.r>c){b.r=Math.max(0,b.r-a.offsetWidth-a.i.offsetWidth+(a.f.offsetWidth-a.offsetWidth));if(z)b.r-=a.i.clientLeft+a.f.clientLeft;}b.s=Math.max(0,Math.min(b.s,d));K(a.i,b);}function N(a){if(a.h==null)return;Y(a.h,"menuItemActive");if(a.h.i!=null)L(a.h.i);a.h=null;}function O(a){var b=(z?U(window.event.srcElement,"DIV","menu"):a.currentTarget);N(b);}function P(a,b){var c=S(a,b);if(s=="keydown"&&c.i.k)c.j=true;M(c);return false;}function Q(a,b){var c=S(a,b);M(c);if(z)window.event.cancelBubble=true;else a.stopPropagation();}function R(a){var b=(z?window.event.keyCode:a.keyCode),c;if(b<37||b>40)return;c=S(a,null);if(b==37){if(c.l.i!=null)c.l.j=true;c.l.focus();}if(b==39){if(c.i!=null)M(c);c.m.focus();}if(b==38)c.n.focus();if(b==40)c.o.focus();return false;}function S(a,b){var c=(z?U(window.event.srcElement,"A","menuItem"):a.currentTarget);if(c.f==null){c.f=U(c,"DIV","menu");if(b!=null&&c.i==null){c.i=document.getElementById(b);c.i.d=c.f.d;c.i.e=c;J(c.i);c.m=c.i.g[0];}}return c;}function T(a){if(a.keyCode<37||a.keyCode>40)return;a.preventDefault();}function U(a,b,c){while(a!=null){if(a.tagName!=null&&a.tagName==b&&W(a,c))return a;a=a.parentNode;}return a;}function V(a,b,c){var d=a.getElementsByTagName(b),e=new Array();for(var f=0;f<d.length;f++)if(W(d[f],c))e.push(d[f]);return e;}function W(el,name){var list=el.className.split(" ");for(var i=0;i<list.length;i++)if(list[i]==name)return true;return false;}function X(a,b){if(!W(a,b))a.className+=(a.className.length>0?" ":"")+b;}function Y(a,b){if(a.className==null)return;var c=new Array(),d=a.className.split(" ");for(var e=0;e<d.length;e++)if(d[e]!=b)c.push(d[e]);a.className=c.join(" ");}function Z(a){var b=0,c=0,d;if(z){d=a;while(d!=null&&d.tagName!=null){if(d.tagName!="BODY"&&d.tagName!="HTML"&&d.tagName!="TABLE"){b+=d.clientLeft;c+=d.clientTop;}d=d.parentNode;}}do{b+=a.offsetLeft;c+=a.offsetTop;a=a.offsetParent;}while(a!=null);return new AA(b,c);}function AA(x,y){this.r=x;this.s=y;}